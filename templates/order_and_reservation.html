{% extends "base.html" %}
{% load static %}
{% block content %}
{% load crispy_forms_tags %}

{% if user.is_authenticated %}
<ul>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'account_email' %}">Change Email</a>
    </li>
</ul>
<ul>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'account_change_password' %}">Change Password</a>
    </li>
</ul>
{% endif %}

<h1>Orders and Reservations</h1>
<p>{{message}}</p>
<h2>Orders</h2>
{% if user.is_authenticated %}
<form action="" method="post">
{% if orders_items is None %}
<p>No orders, make a order in menu page.</p>
{% else %}
{% for orders_item in orders_items %}
<li>Order created on: {{ orders_item.order.created_on }}</li>
<li>Username: {{ orders_item.order.customer.user.username }}</li>
<li>Full Name: {{ orders_item.order.customer.user.first_name }} {{ orders_item.order.customer.user.last_name }}</li>
<li>Address: {{ orders_item.order.customer.address.address }}</li>
<li>Zipcode: {{ orders_item.order.customer.address.zipcode }}</li>
<li>Meal name: {{ orders_item.id_menu.meal_name }}</li>
<li>Meal price: {{ orders_item.price }}</li>
<li>Quantity: {{ orders_item.quantity }}</li>
<li>Total price: {{ orders_item.order.total_price }}</li>
<li>Order ID: {{ orders_item.order.id }}</li>
<li>Email: {{ orders_item.order.customer.user.email }}</li>
{% csrf_token %}
<input id="order_id" value="{{ orders_item.order.id }}" name="order_id" type="hidden">
<button id="delete_order" value="{{ orders_item.order.id }}" name="delete_order">Cancel Order</button>
</form>
<hr>
{% endfor %}
{% endif %}


<h2>Reservations</h2>
{% if reservations_items is None %}
<p>No reservation, do one in menu page.</p>
{% else %}
{% for reservation_item in reservations_items %}
<li>Full Name: {{ reservation_item.username.first_name }} {{ reservation_item.username.last_name }}</li>
<li>Date: {{ reservation_item.reservation_date }}</li>
<li>Time: {{ reservation_item.reservation_time }}</li>
<li>Email: {{ reservation_item.username.email }}</li>

    {% csrf_token %}
    <input id="reservations_items_id" value="{{ reservation_item.id}}" name="reservations_items_id" type="hidden">
    <button id="delete_reservation" value="{{ reservation_item.id }}" name="delete_reservation">Cancel Reservation</button>
<hr>
{% endfor %}
{% endif %}
</form>
{% endif %}

{%endblock%}